let jwt,dotenv,config,response;_f25‍.x([["isAuth",()=>isAuth]]);_f25‍.w("jsonwebtoken",[["default",["jwt"],function(v){jwt=v}]]);_f25‍.w("dotenv",[["default",["dotenv"],function(v){dotenv=v}]]);_f25‍.w("./config",[["default",["config"],function(v){config=v}]]);_f25‍.w("express",[["response",["response"],function(v){response=v}]]);




dotenv.config();
const jwtSecret = config.jwtSecret;


// const isAuth = function(req, res, next) {
//     const token = req.header("token");
//     if (!token) return res.status(401).json({ message: "Auth Error" });  try {
//       const decoded = jwt.verify(token, "randomString");
//       req.user = decoded.user;
//       next();
//     } catch (e) {
//       console.error(e);
//       res.status(500).send({ message: "Invalid Token" });
//     }
//   }

       const isAuth = (request, response, next)=>{
    const token = request.headers.authorization
    if(!token){
        return response.send({msg : "auth error"})   
    }

    try{
        const decoded = jwt.verify(token.slice(7, token.length), "secretkey")
        request.user = decoded
        if(request.user.isAdmin){
            next()
            return response.send("successful")
          
        }else{
            response.send("has to be admin")
        }

    }catch(error){
        _f25‍.g.console.log(error)
    }
    
}
